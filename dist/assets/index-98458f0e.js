(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function i(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(o){if(o.ep)return;o.ep=!0;const r=i(o);fetch(o.href,r)}})();function T(e){let t=e.toString(),i="#000000";return i=i.substring(0,i.length-t.length),i+t}function N(e,t,i){let s="#"+(16777216+(e<<16)+(t<<8)+i).toString(16).slice(1);return s=s.replace("#",""),parseInt(s)}function M(e,t){const i=e.getBoundingClientRect(),s=t.clientX-i.left,o=t.clientY-i.top;return[s,o]}function E(e){const t=["th","st","nd","rd"],i=e%100;return e+(t[(i-20)%10]??t[i]??t[0])}function b(e){return e.sort((t,i)=>t-i)}const L=document.getElementById("addNodeButton"),I=document.getElementById("nodeWrapper"),x=document.getElementById("mainCanvas"),S=document.getElementById("hitCanvas"),n=x.getContext("2d"),C=S.getContext("2d");let P=new FontFace("JetBrainsMonoBold","url(./JetBrainsMono-ExtraBold.ttf)"),$=new FontFace("JetBrainsMono","url(./JetBrainsMono-Bold.ttf)"),a=-1,v=!1,y=!1,g=0,m=[0,0];P.load().then(function(e){document.fonts.add(e),console.log("Font loaded")});$.load().then(function(e){document.fonts.add(e),console.log("Font loaded")});let l={x:-140,y:0},h=[0,0,0,0,0,0,0,0,0,0],d=[],p=[];function B(){F(),J(),k(p),D(),R(d),A(d),window.requestAnimationFrame(B)}function F(){n.clearRect(0,0,x.width,x.height),C.clearRect(0,0,S.width,S.height),n.fillStyle="#2c2d30",n.fillRect(0,0,x.width,x.height)}function J(){for(let e=0;e<5;e++)n.strokeStyle="#616161",n.lineWidth=1,n.fillStyle="#616161",n.textAlign="center",n.font="18px JetBrainsMono",e!=0&&(n.beginPath(),n.roundRect(e*325+25+l.x,45+l.y,100,30,[5]),n.stroke(),n.fillText(`${E(e*2-1)}: ${h[e*2-1]}`,e*325+75+l.x,65+l.y),n.beginPath(),n.moveTo(e*325+75+l.x,75+l.y),n.lineTo(e*325+75+l.x,450+l.y),n.stroke()),n.beginPath(),n.roundRect(e*325+175+l.x,45+l.y,100,30,[5]),n.stroke(),n.fillText(`${E(e*2)}: ${h[e*2]}`,e*325+225+l.x,65+l.y),n.beginPath(),n.moveTo(e*325+225+l.x,75+l.y),n.lineTo(e*325+225+l.x,450+l.y),n.stroke()}function R(e){v||e.forEach((t,i)=>{let s=99999,o=0,r=0;for(let c=0;c<5;c++){let f=99999;if(c!=0){let u=c*325+75-t.x-50;Math.abs(u)<s&&(s=Math.abs(u),o=Math.sign(u),r=c*2-1)}f=c*325+225-t.x-50,Math.abs(f)<s&&(s=Math.abs(f),o=Math.sign(f),r=c*2)}t.y<80&&(e[i].y+=1),t.y>400&&(e[i].y+=-1),s!=0&&(e[i].x+=o),s==0&&t.isSettled==!1&&(h[r]+=t.credits,e[i].isSettled=!0,e[i].semesterIndex=r)})}function A(e){e.forEach((t,i)=>{y||(e[i].selected=!1),O(t.name,t.credits,t.color,t.selected,t.x,t.y,i)})}function O(e,t,i,s,o,r,c){let f=100,u=50;s&&(n.fillStyle="#616161",n.beginPath(),n.roundRect(o+l.x-5,r+l.y-5,f+10,u+10,[5]),n.fill()),n.fillStyle=i,n.beginPath(),n.roundRect(o+l.x,r+l.y,f,u,[5]),n.fill(),n.fillStyle="#000000",n.font="18px JetBrainsMono",n.textAlign="center",n.fillText(e,o+f/2+l.x,r+20+l.y),n.font="14px JetBrainsMono",n.textAlign="center",n.fillText(`credits: ${t}`,o+f/2+l.x,r+40+l.y),C.fillStyle=T(c+1),C.fillRect(o+l.x,r+l.y,f,u)}function k(e){e.forEach((t,i)=>{let s={x:d[t[0]].x+100+l.x,y:d[t[0]].y+25+l.y},o={x:d[t[1]].x+l.x,y:d[t[1]].y+25+l.y};n.lineWidth=5,n.strokeStyle="#3dff57",n.beginPath(),n.moveTo(s.x,s.y),n.bezierCurveTo(s.x+25,s.y,o.x-25,o.y,o.x,o.y),n.stroke()})}function D(){n.fillStyle="#ffffff",n.font="20px JetBrainsMono",n.textAlign="center",y?n.fillText("connection editor enabled",475,485):n.fillText("hold [space] to add connections",475,485)}x.addEventListener("mousedown",function(e){let t=M(x,e),i=C.getImageData(t[0],t[1],1,1).data;if(a=N(i[0],i[1],i[2])-1,a!=-1){if(y==!1)h[d[a].semesterIndex]-=d[a].credits,d[a].isSettled=!1;else if(y==!0){if(d[a].selected=!0,g+=1,g!=2)m[0]=a;else if(g===2){m[1]=a;let o=m,r=!0;p.forEach((c,f)=>{let u=b(c),w=b(m);JSON.stringify(u)==JSON.stringify(w)&&(p.splice(f,1),r=!1)}),r&&p.push(o)}}}v=!0});x.addEventListener("mousemove",function(e){a!=-1?(d[a].x+=e.movementX,d[a].y+=e.movementY):a===-1&&v&&(l.x+=e.movementX,l.x<-700?l.x=-700:l.x>-140&&(l.x=-140))});x.addEventListener("mouseup",function(e){a=-1,v=!1});document.addEventListener("keydown",e=>{e.code==="Space"&&(y=!0)});document.addEventListener("keyup",e=>{e.code==="Space"&&(g=0,m=[0,0],y=!1)});function W(e){let t=document.createElement("div");return t.classList.add("node"),t.id=`node-${e}`,t.innerHTML=`
  <span class="nodeText"> name: <input id="nodeName-${e}" class="nodeInput nodeName" type="text" placeholder="CSC110"> </input></span>
  <span class="nodeText"> credits: <input id="nodeCredits-${e}" class="nodeInput nodeCredits" type="number" min="1" value="3"> </input></span>
  <span class="nodeText"> color: <input id="nodeColor-${e}" class="nodeInput nodeColor" type="color" value="#3dff57" > </input></span>`,t}L.onclick=e=>{let t=W(d.length),i={name:"CSC110",credits:3,color:"#3dff57",isSettled:!1,selected:!1,semesterIndex:0,x:150,y:100};d.push(i),I.appendChild(t)};I.addEventListener("input",e=>{let t=I.children;for(let i=0;i<t.length;i++){let o=t[i].id.split("-")[1],r=parseInt(document.getElementById(`nodeCredits-${o}`).value);h[d[o].semesterIndex]-=d[o].credits,h[d[o].semesterIndex]+=r,d[o].name=document.getElementById(`nodeName-${o}`).value,d[o].credits=r,d[o].color=document.getElementById(`nodeColor-${o}`).value}});window.requestAnimationFrame(B);
